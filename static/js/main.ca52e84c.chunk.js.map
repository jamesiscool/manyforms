{"version":3,"sources":["../../common/build/index.js","../../common/build/expression.js","../../common/build/storeKeys.js","hooks/useStore.tsx","hooks/useExpression.ts","hooks/useShowIf.ts","util.ts","display/Description.tsx","hooks/useFormDef.ts","hooks/useFieldState.ts","hooks/useEvent.ts","hooks/useValues.ts","validation/ValidationRules.ts","hooks/useConfig.ts","hooks/useFormState.ts","hooks/useValidation.ts","hooks/useUpdate.ts","validation/ValidationExpressions.ts","FormDef.ts","formElements/formElementTypes.tsx","display/Label.tsx","display/FieldChrome.tsx","hooks/useReferenceData.ts","svg/octicons/search.svg","formElements/input/Autocomplete.tsx","hooks/usePagination.ts","hooks/useSubmit.ts","formElements/collection/List.tsx","formElements/pagination/Accordion.tsx","formElements/input/Dropdown.tsx","formElements/input/TextInput.tsx","formElements/output/Heading.tsx","formElements/output/Paragraph.tsx","formElements/input/ButtonGroup.tsx","formElements/pagination/Tabs.tsx","hooks/useSuggestion.ts","formElements/output/TextOutput.tsx","formElements/ChildFormElements.tsx","Form.tsx","index.tsx"],"names":["Object","defineProperty","exports","value","expression_1","evaluate","__importDefault","this","mod","__esModule","jexl_1","lodash_es_1","isAlpha_1","isAlphanumeric_1","isCurrency_1","isEmail_1","isNumeric_1","storeKeys_1","default","addTransform","toUpperCase","toLowerCase","addBinaryOp","left","right","store","expression","path","def","extraContex","includeFieldValue","arguments","length","undefined","console","log","context","assign","fieldValue","get","concat","valuesStoreKey","result","evalSync","StoreContext","createContext","StoreProvider","props","useCreateStore","initialState","Provider","children","useReducer","storeState","action","nextStoreState","produce","draftStoreState","actionType","set","array","splice","index","unset","Error","dispatch","defaultValue","getArrayLength","deleteFromCollection","useStore","React","useContext","useExpression","useShowIf","shouldShow","showIf","some","createPath","parentPath","fieldId","Description","id","className","text","useFormDef","formDef","setupFormDef","useFieldState","handleEvent","actions","setFieldValue","fieldDef","expressionExtraContex","data","VALUES_STORE_KEY","setStoreValue","eventType","eventDefs","events","filter","eventDef","triggers","trigger","triggerEventMatches","includes","triggerPathMatches","pathExpression","forEach","actionDef","useEvent","eventHappened","event","getFieldState","Date","now","setSelectedSuggestionLabel","label","FIELD_STATE_STORE_KEY","setShowManualEntryForSuggestion","showen","focus","valueChanged","blur","useValues","setValue","values","getValue","addToCollection","element","getCollectionSize","setValueExpression","expresion","extraContext","setUp","initialValues","validationRules","required","validate","defaultMessage","email","isEmpty","isEmail","alpha","isAlpha","numeric","isNumeric","alphanumeric","isAlphanumeric","currency","isCurrency","defaultConfig","showErrors","showErrorsDelay","disableNextWhenErrors","useConfig","config","setupConfig","formDefinitionConfig","useFormState","setFormState","formState","nextClicked","FORM_STATE_STORE_KEY","clearNextClicked","submitClicked","nextOrSubmit","useValidation","updateAt","useState","setCount","update","count","updateIn","ms","setTimeout","when","useUpdate","validationExpressions","validIf","invalidIf","requiredIf","useValidationExpressions","validation","reduce","message","constraint","validationRule","isValidationExpresionDef","validationExpression","name","validateConstraint","shouldShowErrors","fieldState","timePlusDelayHasPassed","time","validateAndShouldShow","hasErrorsRecursively","childFieldDef","type","childPath","formElementCollectionTypes","hasOwnProperty","size","Label","htmlFor","error","FieldChrome","description","useReferenceData","referenceData","setReferenceData","setupReferenceData","referenceDataDef","http","httpReferenceDataDef","axios","then","response","_extends","target","i","source","key","prototype","call","apply","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","createElement","fillRule","d","_ref","svgRef","title","width","height","viewBox","ref","ForwardRef","forwardRef","defDefaults","options","multiple","labelKey","valueKey","postfixSearchIcon","usePagination","submitting","submit","post","url","outcomeIndex","outcomes","findIndex","outcome","statusCodes","status","catch","useSubmit","setPath","pages","setPages","currentPageIndex","setCurrentPageIndex","firstShownPage","page","lastShownPage","findLastIndex","currentIsFirst","currentIsLast","currentPageHasErrors","disableNext","setupPages","pageDef","previousClicked","times","n","s","v","ordinal","itemLabel","onClick","aria-label","aria-hidden","childFormElements","formElementTypes","pagination","currentPageRef","useRef","useEffect","scrollCurrentPageIntoView","current","window","scroll","top","getBoundingClientRect","goToPage","previous","next","role","aria-multiselectable","map","classNames","disabled","referenceDataOptions","onChange","currentTarget","aria-describedby","onFocus","onBlur","option","Math","random","toString","substring","level","buttonFocus","setButtonFocus","checked","tabsRef","scrollIntoView","pill","href","tabIndex","aria-disabled","suggestions","setSuggestions","httpSuggestions","setHttpSuggestions","inlineSuggestions","setInlineSuggestions","selectedSuggestionLabel","inputValue","setInputValue","showSuggestions","setShowSuggestions","inputChanged","newInputValue","lowerInputValue","trim","lowerSelectedLabel","fieldDefOption","matchingInlineOptions","JSON","stringify","clear","selectOption","valueIsWholeOption","valueExpression","useSuggestion","cursor","setCursor","inputContainerRef","suggestionsContainerRef","showManualEntryForSuggestion","document","body","addEventListener","handlePotentialOutsideClick","removeEventListener","contains","handleInputChange","changedValue","handleBlur","newTarget","activeElement","handleFocus","handleInputKeyDown","keyCode","switchToSuggestLinkLabel","manualDescription","onKeyDown","placement","style","data-placement","suggestion","showSwitchToManualEntryLink","switchToManualEntryLinkLabel","ChildFormElements","elementDef","ChildFormElement","Child","foundType","warn","lookupElement","childProps","Form","useLayoutEffect","elements","ReactDOM","render","getElementById"],"mappings":"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","file":"static/js/main.ca52e84c.chunk.js","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar expression_1 = require(\"./expression\");\n\nexports.evaluate = expression_1.evaluate;","\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar jexl_1 = __importDefault(require(\"jexl\"));\n\nvar lodash_es_1 = require(\"lodash-es\");\n\nvar isAlpha_1 = __importDefault(require(\"validator/lib/isAlpha\"));\n\nvar isAlphanumeric_1 = __importDefault(require(\"validator/lib/isAlphanumeric\"));\n\nvar isCurrency_1 = __importDefault(require(\"validator/lib/isCurrency\"));\n\nvar isEmail_1 = __importDefault(require(\"validator/lib/isEmail\"));\n\nvar isNumeric_1 = __importDefault(require(\"validator/lib/isNumeric\"));\n\nvar storeKeys_1 = require(\"./storeKeys\");\n\njexl_1.default.addTransform('toUpperCase', function (value) {\n  return value.toUpperCase();\n});\njexl_1.default.addTransform('toLowerCase', function (value) {\n  return value.toLowerCase();\n});\njexl_1.default.addTransform('isAlpha', function (value) {\n  return value && isAlpha_1.default(value);\n});\njexl_1.default.addTransform('isAlphanumeric', function (value) {\n  return value && isAlphanumeric_1.default(value);\n});\njexl_1.default.addTransform('isCurrency', function (value) {\n  return value && isCurrency_1.default(value);\n});\njexl_1.default.addTransform('isEmail', function (value) {\n  return value && isEmail_1.default(value);\n});\njexl_1.default.addTransform('isNumeric', function (value) {\n  return value && isNumeric_1.default(value);\n});\njexl_1.default.addBinaryOp('_=', 20, function (left, right) {\n  return left != null && right != null && left.toLowerCase() === right.toLowerCase();\n});\n\nexports.evaluate = function (store, expression, path, def, extraContex) {\n  var includeFieldValue = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : true;\n  console.log('store:', store, expression, path);\n  var context = Object.assign(Object.assign(Object.assign({}, store), {\n    def: def,\n    path: path\n  }), extraContex);\n\n  if (includeFieldValue) {\n    var fieldValue = lodash_es_1.get(store, \"\".concat(storeKeys_1.valuesStoreKey, \".\").concat(path));\n    context.fieldValue = fieldValue;\n    context.value = fieldValue;\n  }\n\n  var result = jexl_1.default.evalSync(expression, context);\n  console.log('result:', result);\n  return result;\n};","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.valuesStoreKey = 'values';","import produce from 'immer'\r\nimport {get, set, unset} from 'lodash-es'\r\nimport React, {createContext, useReducer} from 'react'\r\n\r\ninterface StoreState {\r\n\t[key: string]: any\r\n}\r\n\r\ninterface Store {\r\n\tstore: StoreState,\r\n\tset: (path: string, value: any) => void\r\n\tget: <T extends any>(path: string, defaultValue?: T) => T\r\n\tgetArrayLength: (path: string) => number\r\n\tdeleteFromCollection: (path: string, index: number) => void\r\n}\r\n\r\nexport const StoreContext = createContext<Store | null>(null)\r\n\r\nexport const StoreProvider: React.FC<{ initialState?: StoreState }> = (props) => {\r\n\tconst store = useCreateStore(props.initialState)\r\n\treturn <StoreContext.Provider value={store}>\r\n\t\t{props.children}\r\n\t</StoreContext.Provider>\r\n}\r\n\r\n\r\nconst useCreateStore = (initialState?: StoreState) => {\r\n\tconst [store, dispatch] = useReducer((storeState: StoreState, action: { actionType: 'set' | 'deleteFromCollection' | 'unset', path: string, value?: any, index?: number }) => {\r\n\t\tconst nextStoreState = produce(storeState, draftStoreState => {\r\n\t\t\tswitch (action.actionType) {\r\n\t\t\t\tcase 'set':\r\n\t\t\t\t\tset(draftStoreState, action.path, action.value)\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'deleteFromCollection':\r\n\t\t\t\t\tconst array = get(draftStoreState, action.path) as any[]\r\n\t\t\t\t\tarray.splice(action.index!, 1)\r\n\t\t\t\t\tset(draftStoreState, action.path, array)\r\n\t\t\t\t\tbreak\r\n\t\t\t\tcase 'unset':\r\n\t\t\t\t\tunset(draftStoreState, action.path)\r\n\t\t\t\t\tbreak\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tthrow new Error()\r\n\t\t\t}\r\n\t\t})\r\n\t\tconsole.log('store:', nextStoreState)\r\n\t\treturn nextStoreState\r\n\t}, initialState || {})\r\n\r\n\treturn {\r\n\t\tstore,\r\n\t\tset: (path: string, value: any) => {\r\n\t\t\tconsole.log('set:', path, value)\r\n\t\t\tdispatch({actionType: 'set', path, value})\r\n\r\n\t\t},\r\n\t\tget: <T extends any>(path: string, defaultValue?: T): T => {\r\n\t\t\treturn get(store, path, defaultValue)\r\n\t\t},\r\n\t\tgetArrayLength: (path: string): number => {\r\n\t\t\treturn get(store, path, []).length\r\n\t\t},\r\n\t\tdeleteFromCollection: (path: string, index: number) => {\r\n\t\t\tdispatch({actionType: 'deleteFromCollection', path, index})\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport const useStore = (): Store => {\r\n\tconst store = React.useContext(StoreContext)\r\n\tif (store === null) {\r\n\t\tthrow new Error('Component must be wrapped with <StoreProvider>')\r\n\t}\r\n\treturn store\r\n}\r\n\r\n","import {evaluate} from '@manyforms/common'\r\nimport {ElementDef} from '../FormDef'\r\nimport {useStore} from './useStore'\r\n\r\nexport const useExpression = () => {\r\n\tconst {store} = useStore()\r\n\r\n\treturn {\r\n\t\tevaluate: <T>(expression: string, path?: string, def?: ElementDef, extraContex?: any, includeFieldValue = true): T => {\r\n\t\t\treturn evaluate(store, expression, path, def, extraContex, includeFieldValue)\r\n\t\t}\r\n\t}\r\n}","import {ElementDef} from '../FormDef'\r\nimport {useExpression} from './useExpression'\r\n\r\nexport const useShowIf = () => {\r\n\tconst {evaluate} = useExpression()\r\n\treturn {\r\n\t\tshouldShow: (path: string, def: ElementDef): boolean => {\r\n\t\t\tif (!def.showIf) {\r\n\t\t\t\treturn true\r\n\t\t\t}\r\n\t\t\treturn def.showIf.some(expression => evaluate(expression, path, def))\r\n\t\t}\r\n\t}\r\n}","export const createKey = () => (Math.random() + 1).toString(36).substring(2)\r\n\r\nexport const ordinal = (n: number): string => {\r\n\tconst s = ['th', 'st', 'nd', 'rd'],\r\n\t\tv = n % 100\r\n\treturn n + (s[(v - 20) % 10] || s[v] || s[0])\r\n}\r\n\r\nexport const createPath = (parentPath: string, fieldId?: string): string => {\r\n\tif (!fieldId) {\r\n\t\treturn parentPath\r\n\t}\r\n\tif (parentPath !== '') {\r\n\t\treturn parentPath + '.' + fieldId\r\n\t}\r\n\treturn fieldId\r\n\r\n}","import React from 'react'\r\n\r\ninterface DescriptionProps {\r\n\tpath: string,\r\n\ttext: string\r\n}\r\n\r\nexport const Description = (props: DescriptionProps) => (\r\n\t<div id={props.path + '_description'} className=\"pt-2 text-muted description\">{props.text}</div>\r\n)","import FormDef from '../FormDef'\r\nimport {useStore} from './useStore'\r\n\r\nconst FORM_DEF_STORE_KEY = 'formDef'\r\n\r\nexport const useFormDef = () => {\r\n\tconst {set, get} = useStore()\r\n\treturn {\r\n\t\tformDef: get(FORM_DEF_STORE_KEY) as FormDef,\r\n\t\tsetupFormDef: (formDef: FormDef) => {\r\n\t\t\tset(FORM_DEF_STORE_KEY, formDef)\r\n\t\t}\r\n\t}\r\n}","import {useEvent} from './useEvent'\r\nimport {useStore} from './useStore'\r\n\r\n/*interface FieldStates {\r\n\t[path: string]: FieldState\r\n}*/\r\n\r\ninterface FieldState extends EventTimes {\r\n\tselectedSuggestionLabel?: string\r\n\tshowManualEntryForSuggestion?: boolean\r\n}\r\n\r\ntype EventTimes = {\r\n\t[Event in FieldEvents]?: number; //Date.now() when event first happened on the field\r\n}\r\n\r\nexport type FieldEvents = 'focus' | 'valueChanged' | 'blur'\r\n\r\nconst FIELD_STATE_STORE_KEY = 'fieldStates'\r\n\r\nexport const useFieldState = () => {\r\n\tconst {set, get} = useStore()\r\n\tconst {handleEvent} = useEvent()\r\n\r\n\tconst getFieldState = (path: string): FieldState => get(`${FIELD_STATE_STORE_KEY}.${path}`, {})\r\n\r\n\tconst eventHappened = (path: string, event: FieldEvents) => {\r\n\t\thandleEvent(event,path)\r\n\t\tif (!getFieldState(path)[event]) {\r\n\t\t\tset(`${FIELD_STATE_STORE_KEY}.${path}.${event}`, Date.now())\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\tgetFieldState: (path: string): FieldState => get(`${FIELD_STATE_STORE_KEY}.${path}`, {}),\r\n\r\n\t\tsetSelectedSuggestionLabel: (path: string, label: string) => {\r\n\t\t\tset(FIELD_STATE_STORE_KEY + '.' + path + '.selectedSuggestionLabel', label)\r\n\t\t},\r\n\r\n\t\tsetShowManualEntryForSuggestion: (path: string, showen: boolean) => {\r\n\t\t\tset(FIELD_STATE_STORE_KEY + '.' + path + '.showManualEntryForSuggestion', showen)\r\n\t\t},\r\n\r\n\t\tfocus: (path: string) => eventHappened(path, 'focus'),\r\n\t\tvalueChanged: (path: string) => eventHappened(path, 'valueChanged'),\r\n\t\tblur: (path: string) => eventHappened(path, 'blur'),\r\n\t}\r\n}","import {FieldDef} from '../FormDef'\r\nimport {useExpression} from './useExpression'\r\nimport {FieldEvents} from './useFieldState'\r\nimport {useFormDef} from './useFormDef'\r\nimport {useStore} from './useStore'\r\nimport {VALUES_STORE_KEY} from './useValues'\r\n\r\nexport interface EventDef {\r\n\ttriggers: Trigger[]\r\n\tactions: ActionDef[]\r\n}\r\n\r\ntype EventType = 'formLoaded' | 'beforePageNext' | 'showManualEntryForSuggestion' | FieldEvents\r\n\r\ninterface Trigger {\r\n\teventType: EventType[]\r\n\tpath?: string\r\n\tpathExpression?: string\r\n}\r\n\r\ntype ActionType = 'setFieldValue' | 'setStoreValue'\r\n\r\ninterface ActionDef {\r\n\taction: ActionType,\r\n\tpath?: string\r\n\tdata?: any\r\n\texpression?: string\r\n}\r\n\r\nexport const useEvent = () => {\r\n\tconst {evaluate} = useExpression()\r\n\tconst {set} = useStore()\r\n\tconst {formDef} = useFormDef()\r\n\r\n\r\n\tconst actions: { [action: string]: (actionDef: ActionDef, fieldDef?: FieldDef, expressionExtraContex?: any) => void } = {\r\n\t\tsetFieldValue: ({path, expression, data}, fieldDef, expressionExtraContex) => {\r\n\t\t\tif (path == null) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (data != null) {\r\n\t\t\t\tset(VALUES_STORE_KEY + '.' + path, data)\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (expression) {\r\n\t\t\t\tset(VALUES_STORE_KEY + '.' + path, evaluate(expression, path, fieldDef, expressionExtraContex))\r\n\t\t\t}\r\n\t\t},\r\n\t\tsetStoreValue: ({path, expression, data}, fieldDef, expressionExtraContex) => {\r\n\t\t\tif (path == null) {\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (data != null) {\r\n\t\t\t\tset(path, data)\r\n\t\t\t\treturn\r\n\t\t\t}\r\n\t\t\tif (expression) {\r\n\t\t\t\tset(path, evaluate(expression, path, fieldDef, expressionExtraContex))\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn {\r\n\t\thandleEvent: (eventType: EventType, path?: string, fieldDef?: FieldDef, expressionExtraContex?: any) => {\r\n\t\t\tconsole.log('eventType:', eventType)\r\n\t\t\tconst eventDefs = (formDef && formDef.events) || []\r\n\t\t\tconsole.log('eventDefs:', eventDefs)\r\n\t\t\tconst eventsDefWithMatchingTriggers = eventDefs.filter(eventDef => eventDef.triggers.some(trigger => {\r\n\t\t\t\t\tconst triggerEventMatches = trigger.eventType.includes(eventType)\r\n\t\t\t\t\tconst triggerPathMatches = (trigger.path == null && trigger.pathExpression == null)\r\n\t\t\t\t\t\t|| trigger.path === path\r\n\t\t\t\t\t\t|| (trigger.pathExpression && evaluate(trigger.pathExpression, path, fieldDef, expressionExtraContex))\r\n\t\t\t\t\treturn triggerEventMatches && triggerPathMatches\r\n\t\t\t\t})\r\n\t\t\t)\r\n\t\t\teventsDefWithMatchingTriggers.forEach(eventDef => eventDef.actions.forEach(actionDef => {\r\n\t\t\t\tconst action = actions[actionDef.action]\r\n\t\t\t\tif (action) {\r\n\t\t\t\t\taction(actionDef, fieldDef, expressionExtraContex)\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\r\n\t\t}\r\n\t}\r\n}","import {ElementDef} from '../FormDef'\r\nimport {useExpression} from './useExpression'\r\nimport {useFieldState} from './useFieldState'\r\nimport {useStore} from './useStore'\r\n\r\nexport const VALUES_STORE_KEY = 'values'\r\n\r\nexport const useValues = () => {\r\n\tconst store = useStore()\r\n\tconst {valueChanged} = useFieldState()\r\n\tconst {evaluate} = useExpression()\r\n\r\n\tconst setValue = (path: string, value: any) => {\r\n\t\tstore.set(`${VALUES_STORE_KEY}.${path}`, value)\r\n\t\tvalueChanged(path)\r\n\t}\r\n\r\n\r\n\treturn {\r\n\t\tvalues: store.get(VALUES_STORE_KEY),\r\n\t\tsetValue,\r\n\t\tgetValue: (path: string): string => {\r\n\t\t\treturn store.get(`${VALUES_STORE_KEY}.${path}`)\r\n\t\t},\r\n\t\taddToCollection: (path: string, element: any = {}) => {\r\n\t\t\tsetValue(`${path}[${store.getArrayLength(`${VALUES_STORE_KEY}.${path}`)}]`, element)\r\n\t\t},\r\n\t\tdeleteFromCollection: (path: string, index: number) => {\r\n\t\t\tstore.deleteFromCollection(`${VALUES_STORE_KEY}.${path}`, index)\r\n\t\t},\r\n\t\tgetCollectionSize: (path: string) => {\r\n\t\t\treturn store.getArrayLength(`${VALUES_STORE_KEY}.${path}`)\r\n\t\t},\r\n\t\tsetValueExpression: (path: string, def: ElementDef, expresion: string, extraContext?: any) => {\r\n\t\t\tsetValue(path, evaluate(expresion, path, def, extraContext, false))\r\n\t\t},\r\n\t\tsetUp: (initialValues = {}) => {\r\n\t\t\tstore.set(VALUES_STORE_KEY, initialValues)\r\n\t\t}\r\n\t}\r\n}","import isAlpha from 'validator/lib/isAlpha'\r\nimport isAlphanumeric from 'validator/lib/isAlphanumeric'\r\nimport isCurrency from 'validator/lib/isCurrency'\r\nimport isEmail from 'validator/lib/isEmail'\r\nimport isEmpty from 'validator/lib/isEmpty'\r\nimport isNumeric from 'validator/lib/isNumeric'\r\n\r\ninterface ValidationRule {\r\n\tvalidate: (value: string, args?: string | string[]) => boolean,\r\n\tdefaultMessage: string\r\n}\r\n\r\nexport const validationRules: { [name: string]: ValidationRule } = {\r\n\trequired: {\r\n\t\tvalidate: (value: string) => !(value == null || value.length <= 0 || value === ''),\r\n\t\tdefaultMessage: 'This field is required'\r\n\t},\r\n\temail: {\r\n\t\tvalidate: (value: string) => isEmpty(value) || isEmail(value),\r\n\t\tdefaultMessage: 'This field must be an email address'\r\n\t},\r\n\talpha: {\r\n\t\tvalidate: (value: string) => isEmpty(value) || isAlpha(value),\r\n\t\tdefaultMessage: 'This field must be only letters'\r\n\t},\r\n\tnumeric: {\r\n\t\tvalidate: (value: string) => isEmpty(value) || isNumeric(value),\r\n\t\tdefaultMessage: 'This field must be only numbers'\r\n\t},\r\n\talphanumeric: {\r\n\t\tvalidate: (value: string) => isEmpty(value) || isAlphanumeric(value),\r\n\t\tdefaultMessage: 'This field must be only letters and numbers'\r\n\t},\r\n\tcurrency: {\r\n\t\tvalidate: (value: string) => isEmpty(value) || isCurrency(value),\r\n\t\tdefaultMessage: 'This field must be a currency amount'\r\n\t}\r\n}","import {useStore} from './useStore'\r\n\r\ntype showErrors = 'immediately' | 'onFocus' | 'onValueChanged' | 'onBlur' | 'nextOrSummit'\r\n\r\nexport interface Config {\r\n\tshowErrors: showErrors\r\n\tshowErrorsDelay: number //milliseconds\r\n\tdisableNextWhenErrors: boolean\r\n}\r\n\r\nconst defaultConfig: Config = {\r\n\tshowErrors: 'onFocus',\r\n\tshowErrorsDelay: 500,\r\n\tdisableNextWhenErrors: false\r\n}\r\n\r\nconst CONFIG_STORE_KEY = 'config'\r\n\r\nexport const useConfig = () => {\r\n\tconst {set, get} = useStore()\r\n\treturn {\r\n\t\tconfig: get(CONFIG_STORE_KEY) || {},\r\n\t\tsetupConfig: (formDefinitionConfig = {}) => {\r\n\t\t\tset(CONFIG_STORE_KEY, {...defaultConfig, ...formDefinitionConfig})\r\n\t\t}\r\n\t}\r\n}","import {useStore} from './useStore'\r\n\r\ntype FormState = {\r\n\tnextClicked?: number //Date.now()\r\n\tsubmitClicked?: number\r\n\tsubmitting?: boolean\r\n\toutcomeIndex?: number\r\n\tsubmitResponse?:any\r\n\tsubmitError?:any\r\n}\r\n\r\nconst FORM_STATE_STORE_KEY = 'formState'\r\n\r\nexport const useFormState = () => {\r\n\tconst {set, get} = useStore()\r\n\tconst setFormState = (path: keyof FormState, value: any) => {\r\n\t\tset(`${FORM_STATE_STORE_KEY}.${path}`, value)\r\n\t}\r\n\r\n\treturn {\r\n\t\tformState: get<FormState>(FORM_STATE_STORE_KEY, {}),\r\n\t\tsetFormState,\r\n\t\tnextClicked: () => {\r\n\t\t\tif (!get(FORM_STATE_STORE_KEY + '.nextClicked')) {\r\n\t\t\t\tsetFormState('nextClicked', Date.now())\r\n\t\t\t}\r\n\t\t},\r\n\t\tclearNextClicked: () => {\r\n\t\t\tsetFormState('nextClicked', undefined)\r\n\t\t},\r\n\t\tsubmitClicked: () => {\r\n\t\t\tif (!get(FORM_STATE_STORE_KEY + '.submitClicked')) {\r\n\t\t\t\tsetFormState('submitClicked', Date.now())\r\n\t\t\t}\r\n\t\t},\r\n\t\tnextOrSubmit: (): boolean => {\r\n\t\t\treturn (get(FORM_STATE_STORE_KEY + '.nextClicked') || get(FORM_STATE_STORE_KEY + '.submitClicked'))\r\n\t\t}\r\n\t}\r\n}","import {ElementDef, FieldDef, isValidationExpresionDef, ValidationConstraintDef} from '../FormDef'\r\nimport {isTypeACollection} from '../formElements/formElementTypes'\r\nimport {createPath} from '../util'\r\nimport {useValidationExpressions} from '../validation/ValidationExpressions'\r\nimport {validationRules} from '../validation/ValidationRules'\r\nimport {useConfig} from './useConfig'\r\nimport {useFieldState} from './useFieldState'\r\nimport {useFormState} from './useFormState'\r\nimport {useShowIf} from './useShowIf'\r\nimport {useUpdate} from './useUpdate'\r\nimport {useValues} from './useValues'\r\n\r\nexport const useValidation = () => {\r\n\tconst config = useConfig().config\r\n\tconst {getValue, getCollectionSize} = useValues()\r\n\tconst {getFieldState} = useFieldState()\r\n\tconst {nextOrSubmit} = useFormState()\r\n\tconst {shouldShow} = useShowIf()\r\n\tconst {updateAt} = useUpdate()\r\n\tconst validationExpressions = useValidationExpressions()\r\n\r\n\tconst validate = (path: string, def: FieldDef): string | null => {\r\n\t\tif (!def.validation || def.validation.length <= 0) {\r\n\t\t\treturn null\r\n\t\t}\r\n\t\treturn def.validation.reduce<string | null>((message, constraint): string | null => {\r\n\t\t\tif (message != null) {\r\n\t\t\t\treturn message\r\n\t\t\t}\r\n\t\t\treturn validateConstraint(constraint, path, def)\r\n\t\t}, null)\r\n\t}\r\n\r\n\tfunction validateConstraint(constraint: ValidationConstraintDef | string, path: string, def: ElementDef): string | null {\r\n\t\tif (typeof constraint === 'string') {\r\n\t\t\tconst fieldValue = getValue(path) || ''\r\n\t\t\tconst validationRule = validationRules[constraint]\r\n\t\t\tif (!validationRule.validate(fieldValue)) {\r\n\t\t\t\treturn validationRule.defaultMessage\r\n\t\t\t}\r\n\t\t\treturn null\r\n\t\t} else if (!isValidationExpresionDef(constraint)) {\r\n\t\t\tconst fieldValue = getValue(path) || ''\r\n\t\t\tconst validationRule = validationRules[constraint.name]\r\n\t\t\tif (!validationRule.validate(fieldValue)) {\r\n\t\t\t\treturn constraint.message || validationRule.defaultMessage\r\n\t\t\t}\r\n\t\t\treturn null\r\n\t\t} else {\r\n\t\t\tconst validationExpression = validationExpressions[constraint.name]\r\n\t\t\tif (!validationExpression.validate(path, def, constraint.expression)) {\r\n\t\t\t\treturn constraint.message || validationExpression.defaultMessage\r\n\t\t\t}\r\n\t\t\treturn null\r\n\t\t}\r\n\t}\r\n\r\n\tconst validateAndShouldShow = (path: string, def: ElementDef): string | null => {\r\n\t\treturn shouldShowErrors(path) ? validate(path, def) : null\r\n\t}\r\n\r\n\tconst shouldShowErrors = (path: string): boolean => {\r\n\t\tif (nextOrSubmit() || config.showErrors === 'immediately') {\r\n\t\t\treturn true\r\n\t\t}\r\n\t\tconst fieldState = getFieldState(path) || {}\r\n\t\tif (config.showErrors === 'onFocus' && fieldState.focus) {\r\n\t\t\treturn timePlusDelayHasPassed(fieldState.focus)\r\n\t\t}\r\n\t\tif (config.showErrors === 'onValueChanged' && fieldState.valueChanged) {\r\n\t\t\treturn timePlusDelayHasPassed(fieldState.valueChanged)\r\n\t\t}\r\n\t\tif (config.showErrors === 'onBlur' && fieldState.blur) {\r\n\t\t\treturn timePlusDelayHasPassed(fieldState.blur)\r\n\t\t}\r\n\t\treturn false\r\n\t}\r\n\r\n\tconst timePlusDelayHasPassed = (time: number) => {\r\n\t\tif (!config.showErrorsDelay || config.showErrorsDelay === 0) {\r\n\t\t\treturn true\r\n\t\t} else if ((time + config.showErrorsDelay) < Date.now()) {\r\n\t\t\treturn true\r\n\t\t} else {\r\n\t\t\tupdateAt(time + config.showErrorsDelay)\r\n\t\t\treturn false\r\n\t\t}\r\n\t}\r\n\r\n\tconst hasErrorsRecursively = (path: string, def?: ElementDef): boolean => {\r\n\t\tif (!def || !shouldShow(path, def)) {\r\n\t\t\treturn false\r\n\t\t}\r\n\t\tif (validate(path, def) != null) {\r\n\t\t\treturn true\r\n\t\t}\r\n\t\tif (def.children) {\r\n\t\t\treturn def.children.some((childFieldDef) => {\r\n\t\t\t\tconst childPath = createPath(path, childFieldDef.fieldId)\r\n\t\t\t\tif (!shouldShow(childPath, childFieldDef)) {\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t\tif (isTypeACollection(childFieldDef.type)) {\r\n\t\t\t\t\tconst size = getCollectionSize(childPath)\r\n\t\t\t\t\tfor (let index = 0; index < size; index++) {\r\n\t\t\t\t\t\tif (hasErrorsRecursively(childPath + '[' + index + ']', childFieldDef)) {\r\n\t\t\t\t\t\t\treturn true\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn false\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn hasErrorsRecursively(childPath, childFieldDef)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn false\r\n\t}\r\n\r\n\r\n\treturn {validate, shouldShowErrors, validateAndShouldShow, hasErrorsRecursively}\r\n}","import {useState} from 'react'\n\n// Based on useUpdate, useTimeout & useTimeoutFn from https://github.com/streamich/react-use\nexport const useUpdate = () => {\n\tconst [, setCount] = useState(0)\n\tconst update = () => setCount(count => count + 1)\n\n\tconst updateIn = (ms: number) => {\n\t\tsetTimeout(() => {\n\t\t\tupdate()\n\t\t}, ms)\n\t}\n\n\treturn {\n\t\tupdate,\n\t\tupdateIn,\n\t\tupdateAt: (when: number) => {\n\t\t\tupdateIn(when - Date.now())\n\t\t}\n\t}\n}","import {ElementDef} from '../FormDef'\r\nimport {useExpression} from '../hooks/useExpression'\r\nimport {useValues} from '../hooks/useValues'\r\nimport {validationRules} from './ValidationRules'\r\n\r\nexport const useValidationExpressions = () => {\r\n\tconst {evaluate} = useExpression()\r\n\tconst {getValue} = useValues()\r\n\r\n\tinterface ValidationExpression {\r\n\t\tvalidate: (path: string, def: ElementDef, expression: string) => boolean,\r\n\t\tdefaultMessage: string\r\n\t}\r\n\r\n\tconst validationsExpressions: { [name: string]: ValidationExpression } = {\r\n\t\tvalidIf: {\r\n\t\t\tvalidate: (path: string, def: ElementDef, expression: string) => evaluate(expression, path, def),\r\n\t\t\tdefaultMessage: 'This field is invalid' // The form editor should make the user enter message as this does not give the user any information about why the field is invalid\r\n\t\t},\r\n\t\tinvalidIf: {\r\n\t\t\tvalidate: (path: string, def: ElementDef, expression: string) => !evaluate(expression, path, def),\r\n\t\t\tdefaultMessage: 'This field is invalid' // As with validIf form editor should make the user enter message as this does not give the user any information about why the field is invalid\r\n\t\t},\r\n\t\trequiredIf: {\r\n\t\t\tvalidate: (path: string, def: ElementDef, expression: string) => {\r\n\t\t\t\tif (evaluate(expression, path, def)) {\r\n\t\t\t\t\treturn validationRules.required.validate(getValue(path))\r\n\t\t\t\t}\r\n\t\t\t\treturn true\r\n\t\t\t},\r\n\t\t\tdefaultMessage: validationRules.required.defaultMessage\r\n\t\t}\r\n\t}\r\n\r\n\treturn validationsExpressions\r\n}","import {Config} from './hooks/useConfig'\r\nimport {EventDef} from './hooks/useEvent'\r\n\r\nexport default interface FormDef {\r\n\telements: ElementDef[]\r\n\tconfig?: Config\r\n\treferenceData?: ReferenceDataDef\r\n\tsubmit: {\r\n\t\turl: string,\r\n\t\toutcomes: {\r\n\t\t\tstatusCodes: number[]\r\n\t\t\telements: ElementDef[]\r\n\t\t}[]\r\n\t}\r\n\tevents: EventDef[]\r\n}\r\n\r\nexport interface ElementDef {\r\n\tfieldId?: string,\r\n\ttype: string,\r\n\tchildren?: Array<ElementDef>\r\n\tshowIf?: string[]\r\n\thidden: boolean\r\n\tlabel?: string\r\n}\r\n\r\nexport interface FieldDef extends ElementDef {\r\n\tvalidation?: Array<string | ValidationConstraintDef>\r\n\tshowIf?: string[]\r\n\thidden: boolean\r\n\tdescription?: string\r\n\tinfo?: string\r\n}\r\n\r\nexport type ValidationConstraintDef = ValidationRuleDef | ValidationExpresionDef\r\n\r\nexport function isValidationExpresionDef(constraint: ValidationConstraintDef): constraint is ValidationExpresionDef {\r\n\treturn (constraint as ValidationExpresionDef).expression !== undefined\r\n}\r\n\r\nexport interface ValidationRuleDef {\r\n\tname: string,\r\n\targuments?: string[],\r\n\tmessage?: string\r\n}\r\n\r\nexport interface ValidationExpresionDef {\r\n\tname: string,\r\n\texpression: string,\r\n\tmessage?: string\r\n}\r\n\r\nexport interface ReferenceDataDef {\r\n\tinline?: {\r\n\t\t[name: string]: any\r\n\t}\r\n\thttp?: {\r\n\t\tname: string,\r\n\t\turl: string,\r\n\t\tmethod?: 'get' | 'GET' | 'post' | 'POST',\r\n\t\tbaseURL?: string\r\n\t}[]\r\n}\r\n\r\n","import React from 'react'\r\nimport {List} from './collection/List'\r\nimport {Autocomplete} from './input/Autocomplete'\r\nimport {ButtonGroup} from './input/ButtonGroup'\r\nimport {Dropdown} from './input/Dropdown'\r\nimport {TextInput} from './input/TextInput'\r\nimport {Heading} from './output/Heading'\r\nimport {Paragraph} from './output/Paragraph'\r\nimport {TextOutput} from './output/TextOutput'\r\nimport {Accordion} from './pagination/Accordion'\r\nimport {Tabs} from './pagination/Tabs'\r\n\r\ninterface FormElementTypesMap {\r\n\t[type: string]: React.ReactNode\r\n}\r\n\r\nexport const formElementNonCollectionTypes: FormElementTypesMap = {\r\n\t'accordion': Accordion,\r\n\t'dropdown': Dropdown,\r\n\t'textInput': TextInput,\r\n\t'heading': Heading,\r\n\t'paragraph': Paragraph,\r\n\t'buttonGroup': ButtonGroup,\r\n\t'tabs': Tabs,\r\n\t'autocomplete': Autocomplete,\r\n\t'textOutput': TextOutput\r\n}\r\n\r\nexport const formElementCollectionTypes: FormElementTypesMap = {\r\n\t'list': List\r\n}\r\n\r\nexport const formElementTypes: FormElementTypesMap = {...formElementNonCollectionTypes, ...formElementCollectionTypes}\r\n\r\nexport function lookupElement(type: string): React.ReactNode {\r\n\tconst foundType = formElementTypes[type]\r\n\tif (!foundType) {\r\n\t\tconsole.warn('Could not find form element type:' + type)\r\n\t\treturn () => <div>Could not find form element type <code>{type}</code>.</div>\r\n\t}\r\n\treturn foundType\r\n}\r\n\r\nexport function isTypeACollection(type: string): boolean {\r\n\treturn formElementCollectionTypes.hasOwnProperty(type)\r\n}","import React from 'react'\r\n\r\ninterface LabelProps {\r\n\ttext: string,\r\n\thtmlFor: string,\r\n\terror?: boolean\r\n}\r\n\r\nexport const Label = (props: LabelProps) => <label htmlFor={props.htmlFor} className={'mr-2 ' + (props.error ? 'text-danger' : '')}>{props.text}</label>","import React from 'react'\r\nimport {FieldDef} from '../FormDef'\r\nimport {useValidation} from '../hooks/useValidation'\r\nimport {Description} from './Description'\r\nimport {Label} from './Label'\r\n\r\n\r\ninterface FieldChromeProps {\r\n\tpath: string\r\n\tdef: FieldDef\r\n}\r\n\r\nexport const FieldChrome: React.FC<FieldChromeProps> = (props) => {\r\n\tconst error = useValidation().validateAndShouldShow(props.path, props.def)\r\n\r\n\treturn <div className=\"form-group pt-1\">\r\n\t\t{props.def.label && <Label htmlFor={props.path} text={props.def.label} error={!!error}/>}\r\n\t\t{props.children}\r\n\t\t{error && <div className=\"error-message text-danger pt-2\">{error}</div>}\r\n\t\t{props.def.description && <Description path={props.path} text={props.def.description}/>}\r\n\t</div>\r\n}","import axios from 'axios'\r\nimport {ReferenceDataDef} from '../FormDef'\r\nimport {useStore} from './useStore'\r\n\r\ninterface ReferenceData {\r\n\t[name: string]: any\r\n}\r\n\r\nconst REFERENCE_DATA_STORE_KEY = 'referenceData'\r\n\r\nexport const useReferenceData = () => {\r\n\tconst {set, get} = useStore()\r\n\r\n\treturn {\r\n\t\treferenceData: get<ReferenceData>(REFERENCE_DATA_STORE_KEY),\r\n\t\tsetReferenceData: (name: string, data: any) => {\r\n\t\t\tset(`${REFERENCE_DATA_STORE_KEY}.${name}`, data)\r\n\t\t},\r\n\t\tsetupReferenceData: (referenceDataDef: ReferenceDataDef = {}) => {\r\n\t\t\treferenceDataDef.http!.forEach(httpReferenceDataDef => {\r\n\t\t\t\taxios(httpReferenceDataDef)\r\n\t\t\t\t\t.then(function (response) {\r\n\t\t\t\t\t\tset(`${REFERENCE_DATA_STORE_KEY}.${httpReferenceDataDef.name}`, response.data)\r\n\t\t\t\t\t})\r\n\t\t\t})\r\n\t\t}\r\n\t}\r\n}","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React from \"react\";\n\nvar _ref2 =\n/*#__PURE__*/\nReact.createElement(\"path\", {\n  fillRule: \"evenodd\",\n  d: \"M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z\"\n});\n\nvar SvgSearch = function SvgSearch(_ref) {\n  var svgRef = _ref.svgRef,\n      title = _ref.title,\n      props = _objectWithoutProperties(_ref, [\"svgRef\", \"title\"]);\n\n  return React.createElement(\"svg\", _extends({\n    width: 16,\n    height: 16,\n    viewBox: \"0 0 16 16\",\n    ref: svgRef\n  }, props), React.createElement(\"title\", null, title), _ref2);\n};\n\nvar ForwardRef = React.forwardRef(function (props, ref) {\n  return React.createElement(SvgSearch, _extends({\n    svgRef: ref\n  }, props));\n});\nexport default __webpack_public_path__ + \"static/media/search.bf4782c8.svg\";\nexport { ForwardRef as ReactComponent };","import React, {KeyboardEvent, useEffect, useRef, useState} from 'react'\r\nimport {Manager, Popper, Reference} from 'react-popper'\r\nimport {Description} from '../../display/Description'\r\nimport {FieldChrome} from '../../display/FieldChrome'\r\nimport {Label} from '../../display/Label'\r\nimport {useFieldState} from '../../hooks/useFieldState'\r\nimport {SuggestDef, useSuggestion} from '../../hooks/useSuggestion'\r\nimport {ReactComponent as Search} from '../../svg/octicons/search.svg'\r\nimport {ChildFormElements} from '../ChildFormElements'\r\nimport {FormElementProps} from '../FormElementProps'\r\n\r\nexport interface AutocompleteDef extends SuggestDef {\r\n\tlabel: string\r\n\tdescription: string\r\n\tmanualDescription: string\r\n\tinfo?: string\r\n\tpostfixSearchIcon?: boolean\r\n\tshowSwitchToManualEntryLink: boolean\r\n\tswitchToManualEntryLinkLabel?: string\r\n\tswitchToSuggestLinkLabel?: string\r\n}\r\n\r\nconst defDefaults: Partial<AutocompleteDef> = {\r\n\toptions: [],\r\n\tmultiple: false,\r\n\tlabelKey: 'label',\r\n\tvalueKey: 'value',\r\n\tpostfixSearchIcon: true\r\n}\r\n\r\nexport const Autocomplete = (props: FormElementProps<AutocompleteDef>) => {\r\n\tconst def = {...defDefaults, ...props.def}\r\n\r\n\tconst {focus, blur, getFieldState, setShowManualEntryForSuggestion} = useFieldState()\r\n\tconst {inputValue, inputChanged, suggestions, showSuggestions, clear, selectOption} = useSuggestion(props.path, props.def)\r\n\tconst [cursor, setCursor] = useState<number>(-1)\r\n\r\n\tconst inputContainerRef = useRef<HTMLDivElement>(null)\r\n\tconst suggestionsContainerRef = useRef<HTMLDivElement>(null)\r\n\r\n\tconst showManualEntryForSuggestion = getFieldState(props.path).showManualEntryForSuggestion\r\n\r\n\tuseEffect(() => {\r\n\t\tif (showSuggestions && suggestions && suggestions.length > 0) {\r\n\t\t\tinputContainerRef.current!.scrollIntoView()\r\n\t\t}\r\n\t}, [showSuggestions, suggestions])\r\n\r\n\tuseEffect(() => {\r\n\t\tdocument.body.addEventListener('touchend', handlePotentialOutsideClick!)\r\n\t\tdocument.body.addEventListener('click', handlePotentialOutsideClick!)\r\n\t\treturn () => {\r\n\t\t\tdocument.body.removeEventListener('touchend', handlePotentialOutsideClick!)\r\n\t\t\tdocument.body.removeEventListener('click', handlePotentialOutsideClick!)\r\n\t\t}\r\n\t})\r\n\r\n\tconst handlePotentialOutsideClick = (event: Event) => {\r\n\t\tif (!showManualEntryForSuggestion\r\n\t\t\t&& inputContainerRef && !inputContainerRef.current!.contains(event.target as Node)\r\n\t\t\t&& suggestionsContainerRef && !suggestionsContainerRef.current!.contains(event.target as Node)) {\r\n\t\t\tclear()\r\n\t\t}\r\n\t}\r\n\tconst handleInputChange = (changedValue: string) => {\r\n\t\tinputChanged(changedValue)\r\n\t\tsetCursor(-1)\r\n\t}\r\n\tconst handleSelectionClicked = (option: any) => {\r\n\t\tselectOption(option)\r\n\t\tsetCursor(-1)\r\n\t}\r\n\tconst handleBlur = () => {\r\n\t\tblur(props.path)\r\n\t\tsetTimeout(() => {\r\n\t\t\tconst newTarget = document.activeElement\r\n\t\t\tif (!inputContainerRef.current!.contains(newTarget) && !suggestionsContainerRef.current!.contains(newTarget)) {\r\n\t\t\t\tclear()\r\n\t\t\t}\r\n\t\t}, 1)// Have to wait 1 ms so that document.activeElement is not body\r\n\t}\r\n\tconst handleFocus = () => {\r\n\t\tfocus(props.path)\r\n\t\tif (inputValue && inputValue.length > 0) {\r\n\t\t\thandleInputChange(inputValue)\r\n\t\t}\r\n\t}\r\n\tconst handleInputKeyDown = (event: KeyboardEvent) => {\r\n\t\tif (event.keyCode === 38 && cursor > 0) { // up\r\n\t\t\tsetCursor(cursor - 1)\r\n\t\t} else if (event.keyCode === 40 && cursor < suggestions.length - 1) { // down\r\n\t\t\tsetCursor(cursor + 1)\r\n\t\t} else if (event.keyCode === 13 && cursor >= 0 && cursor < suggestions.length) { // enter\r\n\t\t\tselectOption(suggestions[cursor])\r\n\t\t} else if (event.keyCode === 27) { // esc\r\n\t\t\tclear()\r\n\t\t}\r\n\t}\r\n\r\n\tif (!showManualEntryForSuggestion) {\r\n\t\treturn <>\r\n\t\t\t<FieldChrome path={props.path} def={props.def}>\r\n\t\t\t\t<Manager>\r\n\t\t\t\t\t<Reference>\r\n\t\t\t\t\t\t{({ref}) => (<div ref={inputContainerRef} className=\"input-group\">\r\n\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\tref={ref}\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t\tclassName=\"form-control\"\r\n\t\t\t\t\t\t\t\t\tid={props.path}\r\n\t\t\t\t\t\t\t\t\taria-describedby={props.path + '_description'}\r\n\t\t\t\t\t\t\t\t\tvalue={inputValue || ''}\r\n\t\t\t\t\t\t\t\t\tonChange={event => handleInputChange(event.target.value)}\r\n\t\t\t\t\t\t\t\t\tonKeyDown={handleInputKeyDown}\r\n\t\t\t\t\t\t\t\t\tonFocus={handleFocus}\r\n\t\t\t\t\t\t\t\t\tonBlur={handleBlur}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t{def.postfixSearchIcon && <div className=\"input-group-append\" onClick={() => inputChanged(inputValue)}>\r\n\t\t\t\t\t\t\t<span className=\"input-group-text\">\r\n\t\t\t\t\t\t\t\t<Search className=\"search-icon\"/>\r\n\t\t\t\t\t\t\t</span>\r\n\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Reference>\r\n\t\t\t\t\t<Popper placement=\"bottom-start\">\r\n\t\t\t\t\t\t{({ref, style, placement}) => (\r\n\t\t\t\t\t\t\t<div ref={suggestionsContainerRef}>\r\n\t\t\t\t\t\t\t\t<div ref={ref} style={style} className=\"popper\" data-placement={placement}>\r\n\t\t\t\t\t\t\t\t\t{showSuggestions && suggestions && suggestions.length > 0 && <div className=\"dropdown-menu show\">\r\n\t\t\t\t\t\t\t\t\t\t{suggestions.map((suggestion, index) => {\r\n\t\t\t\t\t\t\t\t\t\t\tlet value\r\n\t\t\t\t\t\t\t\t\t\t\tlet label\r\n\t\t\t\t\t\t\t\t\t\t\tif (typeof suggestion === 'string') {\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue = suggestion\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel = suggestion\r\n\t\t\t\t\t\t\t\t\t\t\t} else if (typeof suggestion === 'object') {\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue = def.valueKey && suggestion[def.valueKey]\r\n\t\t\t\t\t\t\t\t\t\t\t\tlabel = def.labelKey && suggestion[def.labelKey]\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\treturn <button className={'dropdown-item' + (cursor === index ? ' active' : '')} key={value + label} onClick={() => handleSelectionClicked(suggestion)}>{label}</button>\r\n\t\t\t\t\t\t\t\t\t\t})}\r\n\t\t\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t)}\r\n\t\t\t\t\t</Popper>\r\n\t\t\t\t</Manager>\r\n\t\t\t</FieldChrome>\r\n\t\t\t{def.showSwitchToManualEntryLink &&\r\n\t\t\t<button className=\"btn btn-link pt-0 pl-0 manual-entry-link\" onClick={() => setShowManualEntryForSuggestion(props.path, true)}>{def.switchToManualEntryLinkLabel}</button>}\r\n\t\t</>\r\n\t} else {\r\n\t\treturn <div className=\"form-group pt-2\">\r\n\t\t\t{props.def.label && <Label htmlFor={props.path} text={props.def.label}/>}\r\n\t\t\t{props.def.children && <div className=\"card\">\r\n\t\t\t\t<div className=\"card-body\">\r\n\t\t\t\t\t<button className=\"btn btn-link pt-0 pl-0 pb-1 mt-n1\" onClick={() => setShowManualEntryForSuggestion(props.path, false)}>{def.switchToSuggestLinkLabel}</button>\r\n\t\t\t\t\t<ChildFormElements parentPath={props.path} childFormElements={props.def.children}/>\r\n\t\t\t\t</div>\r\n\t\t\t</div>}\r\n\t\t\t{props.def.manualDescription && <Description path={props.path} text={props.def.manualDescription}/>}\r\n\t\t</div>\r\n\t}\r\n}","import {findLastIndex} from 'lodash-es'\r\nimport {useState} from 'react'\r\nimport {ElementDef} from '../FormDef'\r\nimport {useConfig} from './useConfig'\r\nimport {useFormState} from './useFormState'\r\nimport {useShowIf} from './useShowIf'\r\nimport {useSubmit} from './useSubmit'\r\nimport {useValidation} from './useValidation'\r\n\r\nexport const usePagination = () => {\r\n\tconst {config} = useConfig()\r\n\tconst {hasErrorsRecursively} = useValidation()\r\n\tconst {nextClicked, clearNextClicked, submitClicked} = useFormState()\r\n\tconst {shouldShow} = useShowIf()\r\n\tconst {submitting, submit} = useSubmit()\r\n\r\n\tconst [path, setPath] = useState<string>('')\r\n\tconst [pages, setPages] = useState<ElementDef[]>([])\r\n\tconst [currentPageIndex, setCurrentPageIndex] = useState<number>(-1)\r\n\r\n\tconst firstShownPage = pages.findIndex(page => shouldShow(path, page))\r\n\tconst lastShownPage = findLastIndex(pages, page => shouldShow(path, page))\r\n\r\n\tconst currentIsFirst = currentPageIndex === firstShownPage\r\n\tconst currentIsLast = currentPageIndex === lastShownPage\r\n\r\n\tconst currentPageHasErrors = () => hasErrorsRecursively(path, pages[currentPageIndex])\r\n\tconst disableNext = config.disableNextWhenErrors && currentPageHasErrors()\r\n\r\n\r\n\treturn {\r\n\t\tsetUp: (path: string, setupPages: ElementDef[]) => {\r\n\t\t\tsetPath(path)\r\n\t\t\tsetPages(setupPages)\r\n\t\t\tif (currentPageIndex < 0) {\r\n\t\t\t\tsetCurrentPageIndex(setupPages.findIndex(page => shouldShow(path, page)))\r\n\t\t\t}\r\n\t\t},\r\n\t\tnextClicked: () => {\r\n\t\t\tif (currentPageHasErrors()) {\r\n\t\t\t\tnextClicked()\r\n\t\t\t} else {\r\n\t\t\t\tfor (let i = currentPageIndex + 1; i < pages.length; i++) {\r\n\t\t\t\t\tconst pageDef = pages[i]\r\n\t\t\t\t\tif (pageDef && shouldShow(path, pageDef)) {\r\n\t\t\t\t\t\tclearNextClicked()\r\n\t\t\t\t\t\tsetCurrentPageIndex(i)\r\n\t\t\t\t\t\tbreak\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tpreviousClicked: () => {\r\n\t\t\tfor (let i = currentPageIndex - 1; i >= 0; i--) {\r\n\t\t\t\tconst pageDef = pages[i]\r\n\t\t\t\tif (pageDef && shouldShow(path, pageDef)) {\r\n\t\t\t\t\tclearNextClicked()\r\n\t\t\t\t\tsetCurrentPageIndex(i)\r\n\t\t\t\t\tbreak\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t},\r\n\t\tsubmitClicked: () => {\r\n\t\t\tif (currentPageHasErrors()) {\r\n\t\t\t\tsubmitClicked()\r\n\t\t\t} else {\r\n\t\t\t\tsubmit()\r\n\t\t\t}\r\n\t\t},\r\n\t\tcurrentPageIndex, setCurrentPageIndex, currentIsFirst, currentIsLast, currentPageHasErrors, disableNext, submitting\r\n\t}\r\n}","import axios from 'axios'\nimport {useFormDef} from './useFormDef'\nimport {useFormState} from './useFormState'\nimport {useValues} from './useValues'\n\nexport const useSubmit = () => {\n\tconst {formDef} = useFormDef()\n\tconst {values} = useValues()\n\tconst {formState, setFormState} = useFormState()\n\n\n\treturn {\n\t\tsubmitting: formState.submitting,\n\t\tsubmit: () => {\n\t\t\tsetFormState('submitting', true)\n\t\t\taxios.post(formDef.submit.url, values)\n\t\t\t\t.then(function (response) {\n\t\t\t\t\tconsole.log(response)\n\t\t\t\t\tsetFormState('submitting', false)\n\t\t\t\t\tsetFormState('submitResponse', response)\n\t\t\t\t\tconst outcomeIndex = formDef.submit.outcomes.findIndex((outcome) => {\n\t\t\t\t\t\tif (outcome.statusCodes.includes(response.status)) {\n\t\t\t\t\t\t\treturn true\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false\n\t\t\t\t\t})\n\t\t\t\t\tsetFormState('outcomeIndex', outcomeIndex)\n\t\t\t\t}).catch(function (error) {\n\t\t\t\tsetFormState('submitError', error)\n\t\t\t\tconsole.error('error:', error)\n\t\t\t})\n\n\t\t}\n\t}\n}\n","import {times} from 'lodash-es'\r\nimport React from 'react'\r\nimport {Description} from '../../display/Description'\r\nimport {FieldDef} from '../../FormDef'\r\nimport {useValues} from '../../hooks/useValues'\r\nimport {ordinal} from '../../util'\r\nimport {ChildFormElements} from '../ChildFormElements'\r\nimport {FormElementProps} from '../FormElementProps'\r\n\r\n\r\nexport interface ListDef extends FieldDef {\r\n\titemLabel: string\r\n}\r\n\r\nexport const List = (props: FormElementProps<ListDef>) => {\r\n\tconst {getCollectionSize, addToCollection, deleteFromCollection} = useValues()\r\n\treturn (\r\n\t\t<div className=\"form-group\">\r\n\t\t\t<span className=\"h5 align-middle mr-2\">{props.def.label}</span>\r\n\t\t\t{props.def.description && <Description path={props.path} text={props.def.description}/>}\r\n\t\t\t{times(getCollectionSize(props.path), (index: number) =>\r\n\t\t\t\t<div className={'card border-bottom mb-3' + (index === 0 ? ' mt-2' : '')} key={props.path + '_COLLECTION_' + index}>\r\n\t\t\t\t\t<h6 className=\"card-header\">{ordinal(index + 1)} {props.def.itemLabel}\r\n\t\t\t\t\t\t<button className=\"close text-dark\" onClick={() => deleteFromCollection(props.path, index)} aria-label=\"close\">\r\n\t\t\t\t\t\t\t<span aria-hidden=\"true\">&times;</span>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</h6>\r\n\t\t\t\t\t<div className=\"card-body pb-0\">\r\n\t\t\t\t\t\t{props.def.children && <ChildFormElements childFormElements={props.def.children} parentPath={props.path + '[' + index + ']'}/>}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t\t<button className=\"btn btn-primary d-inline\" onClick={() => addToCollection(props.path)}>Add</button>\r\n\t\t</div>)\r\n}\r\n","import classNames from 'classnames'\r\nimport React, {useEffect, useRef} from 'react'\r\nimport {ElementDef} from '../../FormDef'\r\nimport {usePagination} from '../../hooks/usePagination'\r\nimport {useShowIf} from '../../hooks/useShowIf'\r\nimport {ChildFormElements} from '../ChildFormElements'\r\nimport {FormElementProps} from '../FormElementProps'\r\n\r\n\r\nexport const Accordion = (props: FormElementProps) => {\r\n\tconst {shouldShow} = useShowIf()\r\n\tconst pagination = usePagination()\r\n\tconst currentPageRef = useRef<HTMLDivElement>(null)\r\n\r\n\tuseEffect(() => {\r\n\t\tprops.def.children && pagination.setUp(props.path, props.def.children)\r\n\t})\r\n\r\n\tif (!props.def.children) {\r\n\t\treturn null\r\n\t}\r\n\r\n\r\n\tconst scrollCurrentPageIntoView = () => {\r\n\t\tif (currentPageRef && currentPageRef.current) {\r\n\t\t\twindow.scroll({top: currentPageRef.current.getBoundingClientRect().top - 100})\r\n\t\t}\r\n\t}\r\n\r\n\tconst goToPage = (index: number) => {\r\n\t\tpagination.setCurrentPageIndex(index)\r\n\t\tscrollCurrentPageIntoView()\r\n\t}\r\n\r\n\tconst previous = () => {\r\n\t\tpagination.previousClicked()\r\n\t\tscrollCurrentPageIntoView()\r\n\t}\r\n\r\n\tconst next = () => {\r\n\t\tpagination.nextClicked()\r\n\t\tscrollCurrentPageIntoView()\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"accordion\" role=\"tablist\" aria-multiselectable=\"true\">\r\n\t\t\t{props.def.children!.map((page, index) => shouldShow(props.path, page) && <div className=\"card\" key={props.path + '_PAGE_' + index}>\r\n\t\t\t\t\t{pagination.currentPageIndex === index && <div ref={currentPageRef}/>}\r\n\t\t\t\t\t<div className=\"card-header cursor-pointer\" onClick={() => goToPage(index)}>\r\n\t\t\t\t\t\t<h3 className=\"d-inline\">{page.label}</h3>{index < pagination.currentPageIndex && <button className=\"link-button text-muted px-1\" onClick={() => goToPage(index)}><u>edit</u></button>}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{pagination.currentPageIndex === index && <div className=\"card-body m-1\">\r\n\t\t\t\t\t\t{page.children && <ChildFormElements childFormElements={page.children as ElementDef[]} parentPath={props.parentPath}/>}\r\n\t\t\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t\t\t<div className=\"col\">\r\n\t\t\t\t\t\t\t\t<nav aria-label=\"Page navigation\">\r\n\t\t\t\t\t\t\t\t\t<ul className=\"pagination mb-0\">\r\n\t\t\t\t\t\t\t\t\t\t{!pagination.currentIsFirst && <li className=\"page-item\">\r\n\t\t\t\t\t\t\t\t\t\t\t<button className=\"page-link\" onClick={previous}>Previous</button>\r\n\t\t\t\t\t\t\t\t\t\t</li>}\r\n\t\t\t\t\t\t\t\t\t\t{!pagination.currentIsLast && <li className={classNames('page-item', {disabled: pagination.disableNext})}>\r\n\t\t\t\t\t\t\t\t\t\t\t<button className=\"page-link\" onClick={next} disabled={pagination.disableNext}>Next</button>\r\n\t\t\t\t\t\t\t\t\t\t</li>}\r\n\t\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t\t</nav>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t{pagination.currentIsLast && <div className=\"col\">\r\n\t\t\t\t\t\t\t\t<button className=\"btn btn-primary float-right\" onClick={pagination.submitClicked}>Submit</button>\r\n\t\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>}\r\n\t\t\t\t</div>\r\n\t\t\t)}\r\n\t\t</div>\r\n\t)\r\n}","import React from 'react'\r\nimport {FieldChrome} from '../../display/FieldChrome'\r\nimport {FieldDef} from '../../FormDef'\r\nimport {useFieldState} from '../../hooks/useFieldState'\r\nimport {useReferenceData} from '../../hooks/useReferenceData'\r\nimport {useValues} from '../../hooks/useValues'\r\nimport {createKey} from '../../util'\r\nimport {FormElementProps} from '../FormElementProps'\r\n\r\nexport interface DropdownDef extends FieldDef {\r\n\tinfo?: string\r\n\toptions?: string[]\r\n\treferenceDataOptions?: string\r\n}\r\n\r\ninterface Option {\r\n\tvalue: string | number,\r\n\tlabel: string\r\n}\r\n\r\ntype Data = string | number\r\n\r\nexport const Dropdown = (props: FormElementProps<DropdownDef>) => {\r\n\tconst referenceData = useReferenceData().referenceData\r\n\tconst {getValue, setValue} = useValues()\r\n\tconst {blur, focus} = useFieldState()\r\n\tlet options: Array<Option | Data> = props.def.options || []\r\n\tif (props.def.referenceDataOptions) {\r\n\t\toptions = options.concat(referenceData[props.def.referenceDataOptions])\r\n\t}\r\n\treturn <FieldChrome path={props.path} def={props.def}>\r\n\t\t<select\r\n\t\t\tclassName=\"form-control custom-select\"\r\n\t\t\tid={props.def.fieldId}\r\n\t\t\tvalue={getValue(props.path) || ''}\r\n\t\t\tonChange={event => setValue(props.path, event.currentTarget.value)}\r\n\t\t\taria-describedby={props.def.fieldId + '_description'}\r\n\t\t\tonFocus={() => focus(props.path)}\r\n\t\t\tonBlur={() => blur(props.path)}\r\n\t\t>\r\n\t\t\t<option value=\"\"/>\r\n\t\t\t{options.map((option) => {\r\n\t\t\t\tconst label = typeof option === 'object' ? option.label : option\r\n\t\t\t\tconst value = typeof option === 'object' ? option.value : option\r\n\t\t\t\treturn <option value={value} key={value || createKey()}>{label}</option>\r\n\t\t\t})}\r\n\t\t</select>\r\n\t</FieldChrome>\r\n}","import React from 'react'\r\nimport {FieldChrome} from '../../display/FieldChrome'\r\nimport {FieldDef} from '../../FormDef'\r\nimport {useFieldState} from '../../hooks/useFieldState'\r\nimport {useValues} from '../../hooks/useValues'\r\nimport {FormElementProps} from '../FormElementProps'\r\n\r\ninterface TextInputDef extends FieldDef {\r\n}\r\n\r\nexport const TextInput = (props: FormElementProps<TextInputDef>) => {\r\n\tconst {getValue, setValue} = useValues()\r\n\tconst {blur, focus} = useFieldState()\r\n\r\n\treturn (<FieldChrome path={props.path} def={props.def}>\r\n\t\t<input\r\n\t\t\ttype=\"text\"\r\n\t\t\tclassName=\"form-control\"\r\n\t\t\tid={props.path}\r\n\t\t\taria-describedby={props.path + '_description'}\r\n\t\t\tvalue={getValue(props.path) || ''}\r\n\t\t\tonChange={event => setValue(props.path, event.currentTarget.value)}\r\n\t\t\tonFocus={() => focus(props.path)}\r\n\t\t\tonBlur={() => blur(props.path)}\r\n\t\t/>\r\n\t</FieldChrome>)\r\n}","import React from 'react'\nimport {FormElementProps} from '../FormElementProps'\n\ninterface HeadingAttributes {\n\tlevel: number\n\ttext: string\n}\n\nexport const Heading = (props: FormElementProps<HeadingAttributes>) =>\n\tReact.createElement('h' + props.def.level, null, props.def.text)","import React from 'react'\nimport {FormElementProps} from '../FormElementProps'\n\n\ninterface ParagraphAttributes {\n\ttext: string\n}\n\nexport const Paragraph = (props: FormElementProps<ParagraphAttributes>) => <p>{props.def.text}</p>","import React, {useState} from 'react'\r\nimport {FieldChrome} from '../../display/FieldChrome'\r\nimport {FieldDef} from '../../FormDef'\r\nimport {useFieldState} from '../../hooks/useFieldState'\r\n\r\nimport {useValues} from '../../hooks/useValues'\r\nimport {FormElementProps} from '../FormElementProps'\r\n\r\ninterface ButtonGroupDef extends FieldDef {\r\n\tlabel: string\r\n\tdescription?: string\r\n\tinfo?: string\r\n\toptions: string[]\r\n}\r\n\r\nexport const ButtonGroup = (props: FormElementProps<ButtonGroupDef>) => {\r\n\tconst {setValue, getValue} = useValues()\r\n\tconst {blur, focus} = useFieldState()\r\n\tconst value = getValue(props.path)\r\n\tconst [buttonFocus, setButtonFocus] = useState<number | null>(null)\r\n\r\n\treturn (\r\n\t\t<FieldChrome path={props.path} def={props.def}>\r\n\t\t\t<div className=\"btn-group-wrapper\"\r\n\t\t\t\t onFocus={() => focus(props.path)}\r\n\t\t\t\t onBlur={() => blur(props.path)}\r\n\t\t\t>\r\n\t\t\t\t<div className=\"btn-group btn-group-toggle\">\r\n\t\t\t\t\t{props.def.options.map((option, index) => (\r\n\t\t\t\t\t\t<label\r\n\t\t\t\t\t\t\tclassName={'btn btn-outline-primary' + (value === option ? ' active' : '') + (buttonFocus === index ? ' focus' : '')}\r\n\t\t\t\t\t\t\tkey={props.path + '_OPTION_' + option}\r\n\t\t\t\t\t\t\tonFocus={() => setButtonFocus(index)}\r\n\t\t\t\t\t\t\tonBlur={() => setButtonFocus(null)}\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\ttype=\"radio\"\r\n\t\t\t\t\t\t\t\tvalue={option}\r\n\t\t\t\t\t\t\t\tchecked={option === value}\r\n\t\t\t\t\t\t\t\tonChange={event => setValue(props.path, event.currentTarget.value)}\r\n\t\t\t\t\t\t\t/>{option}\r\n\t\t\t\t\t\t</label>))\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</FieldChrome>)\r\n}","import classNames from 'classnames'\r\nimport React, {useEffect, useRef} from 'react'\r\nimport {ElementDef} from '../../FormDef'\r\nimport {usePagination} from '../../hooks/usePagination'\r\nimport {useShowIf} from '../../hooks/useShowIf'\r\nimport {ChildFormElements} from '../ChildFormElements'\r\nimport {FormElementProps} from '../FormElementProps'\r\n\r\ninterface TabsDef extends ElementDef {\r\n\tpill?: boolean\r\n}\r\n\r\n\r\nexport const Tabs = (props: FormElementProps<TabsDef>) => {\r\n\tconst {shouldShow} = useShowIf()\r\n\tconst pagination = usePagination()\r\n\tconst tabsRef = useRef<HTMLDivElement>(null)\r\n\r\n\t/* eslint-disable react-hooks/exhaustive-deps */\r\n\tuseEffect(() => {\r\n\t\tprops.def.children && pagination.setUp(props.path, props.def.children)\r\n\t}, [props.def, props.path])\r\n\t/* eslint-enable react-hooks/exhaustive-deps */\r\n\r\n\tuseEffect(() => {\r\n\t\tif (tabsRef && tabsRef.current && tabsRef.current.getBoundingClientRect().top < 0) {\r\n\t\t\ttabsRef.current.scrollIntoView()\r\n\t\t}\r\n\t}, [pagination.currentPageIndex])\r\n\r\n\tif (!props.def.children) {\r\n\t\treturn null\r\n\t}\r\n\r\n\tif (pagination.currentPageIndex < 0) {\r\n\t\treturn null\r\n\t}\r\n\r\n\treturn (\r\n\t\t<div className=\"card rounded-0\">\r\n\t\t\t<div className=\"card-header\" ref={tabsRef}>\r\n\t\t\t\t<ul className={'nav ' + (props.def.pill ? 'nav-pills card-header-pills' : 'nav-tabs card-header-tabs')}>\r\n\t\t\t\t\t{props.def.children!.map((page, index) => {\r\n\t\t\t\t\t\tif (!shouldShow(props.path, page)) {\r\n\t\t\t\t\t\t\treturn null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tconst key = props.path + '_PAGE_' + index\r\n\t\t\t\t\t\t//The bootstrap btn-link doesn't style the same as a link with a href when used as nav-link\r\n\t\t\t\t\t\t/* eslint-disable jsx-a11y/anchor-is-valid, no-script-url */\r\n\t\t\t\t\t\tif (index < pagination.currentPageIndex) {\r\n\t\t\t\t\t\t\treturn <li className=\"nav-item\" key={key}>\r\n\t\t\t\t\t\t\t\t<a className=\"nav-link\" href=\"javascript:void(0)\" onClick={() => pagination.setCurrentPageIndex(index)}>{page.label}</a>\r\n\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t/* eslint-enable no-script-url, jsx-a11y/anchor-is-valid */\r\n\t\t\t\t\t\tif (index === pagination.currentPageIndex) {\r\n\t\t\t\t\t\t\treturn <li className=\"nav-item\" key={key}>\r\n\t\t\t\t\t\t\t\t<button className=\"nav-link active\">{page.label}</button>\r\n\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (index > pagination.currentPageIndex) {\r\n\t\t\t\t\t\t\treturn <li className=\"nav-item\" key={key}>\r\n\t\t\t\t\t\t\t\t<button className=\"nav-link disabled\" tabIndex={-1} aria-disabled=\"true\">{page.label}</button>\r\n\t\t\t\t\t\t\t</li>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn null\r\n\t\t\t\t\t})}\r\n\t\t\t\t</ul>\r\n\t\t\t</div>\r\n\t\t\t<div className=\"card-body\">\r\n\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t<ChildFormElements childFormElements={props.def.children[pagination.currentPageIndex].children as ElementDef[]} parentPath={props.parentPath}/>\r\n\t\t\t\t\t<div className=\"row\">\r\n\t\t\t\t\t\t<div className=\"col\">\r\n\t\t\t\t\t\t\t<nav aria-label=\"Page navigation\">\r\n\t\t\t\t\t\t\t\t<ul className=\"pagination mb-0\">\r\n\t\t\t\t\t\t\t\t\t{!pagination.currentIsFirst && <li className=\"page-item\">\r\n\t\t\t\t\t\t\t\t\t\t<button className=\"page-link\" onClick={pagination.previousClicked}>Previous</button>\r\n\t\t\t\t\t\t\t\t\t</li>}\r\n\t\t\t\t\t\t\t\t\t{!pagination.currentIsLast && <li className={classNames('page-item', {disabled: pagination.disableNext})}>\r\n\t\t\t\t\t\t\t\t\t\t<button className=\"page-link\" onClick={pagination.nextClicked} disabled={pagination.disableNext}>Next</button>\r\n\t\t\t\t\t\t\t\t\t</li>}\r\n\t\t\t\t\t\t\t\t</ul>\r\n\t\t\t\t\t\t\t</nav>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{pagination.currentIsLast && <div className=\"col\">\r\n\t\t\t\t\t\t\t<button className=\"btn btn-primary float-right\" onClick={pagination.submitClicked}>Submit</button>\r\n\t\t\t\t\t\t</div>}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>)\r\n}","import axios from 'axios'\r\nimport {useEffect, useState} from 'react'\r\nimport {FieldDef} from '../FormDef'\r\nimport {useFieldState} from './useFieldState'\r\nimport {useReferenceData} from './useReferenceData'\r\nimport {useValues} from './useValues'\r\n\r\nexport interface SuggestDef extends FieldDef {\r\n\toptions?: any[]\r\n\treferenceDataOptions?: string\r\n\tmultiple?: boolean\r\n\tlabelKey?: string\r\n\tvalueKey?: string\r\n\tvalueIsWholeOption?: boolean\r\n\tvalueExpression?: string\r\n\thttp?: { url?: string }\r\n}\r\n\r\nexport function useSuggestion(path: string, def: SuggestDef) {\r\n\tconst {referenceData} = useReferenceData()\r\n\tconst {setValue, setValueExpression} = useValues()\r\n\tconst {getFieldState, setSelectedSuggestionLabel} = useFieldState()\r\n\tconst fieldState = getFieldState(path)\r\n\r\n\tconst [suggestions, setSuggestions] = useState<any[]>([])\r\n\tconst [httpSuggestions, setHttpSuggestions] = useState<any[]>([])\r\n\tconst [inlineSuggestions, setInlineSuggestions] = useState<any[]>([])\r\n\tconst [inputValue, setInputValue] = useState<string>(fieldState.selectedSuggestionLabel || '')\r\n\tconst [showSuggestions, setShowSuggestions] = useState(false)\r\n\r\n\tuseEffect(() => {\r\n\t\tsetSuggestions(inlineSuggestions.concat(httpSuggestions))\r\n\t}, [inlineSuggestions, httpSuggestions])\r\n\r\n\tconst inputChanged = (newInputValue: string) => {\r\n\t\tsetInputValue(newInputValue)\r\n\t\tsetInlineSuggestions([])\r\n\t\tsetHttpSuggestions([])\r\n\t\tsetSuggestions([])\r\n\t\tconst lowerInputValue = newInputValue.trim().toLowerCase()\r\n\t\tconst lowerSelectedLabel = fieldState.selectedSuggestionLabel && fieldState.selectedSuggestionLabel.toLowerCase()\r\n\t\tif (lowerInputValue !== lowerSelectedLabel && lowerInputValue.length > 0) {\r\n\t\t\tconst referenceDataOptions = (def.referenceDataOptions && referenceData[def.referenceDataOptions]) || []\r\n\t\t\tconst fieldDefOption = def.options || []\r\n\t\t\tconst inlineOptions = referenceDataOptions.concat(fieldDefOption)\r\n\r\n\t\t\tconst matchingInlineOptions = inlineOptions.filter((option: any) => {\r\n\t\t\t\treturn JSON.stringify(option).toLowerCase().includes(lowerInputValue)\r\n\t\t\t})\r\n\r\n\t\t\tsetInlineSuggestions(matchingInlineOptions)\r\n\r\n\t\t\tif (def.http && def.http.url) {\r\n\t\t\t\taxios.get<any[]>(def.http.url + newInputValue)\r\n\t\t\t\t\t.then(function (response) {\r\n\t\t\t\t\t\tsetHttpSuggestions(response.data)\r\n\t\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tsetShowSuggestions(true)\r\n\t\t}\r\n\t}\r\n\r\n\tconst clear = () => {\r\n\t\tsetShowSuggestions(false)\r\n\t}\r\n\r\n\tconst selectOption = (option: any) => {\r\n\t\tif (typeof option === 'string') {\r\n\t\t\tsetValue(path, option)\r\n\t\t\tsetSelectedSuggestionLabel(path, option)\r\n\t\t\tsetInputValue(option)\r\n\t\t} else if (typeof option === 'object') {\r\n\t\t\tif (def.valueIsWholeOption) {\r\n\t\t\t\tsetValue(path, option)\r\n\t\t\t} else if (def.valueExpression) {\r\n\t\t\t\tsetValueExpression(path, def, def.valueExpression, {option})\r\n\t\t\t} else if (def.valueKey) {\r\n\t\t\t\tsetValue(path, option[def.valueKey])\r\n\t\t\t}\r\n\t\t\tsetSelectedSuggestionLabel(path, option[def.labelKey || 'label'])\r\n\t\t\tsetInputValue(option[def.labelKey || 'label'])\r\n\r\n\t\t}\r\n\t\tsetShowSuggestions(false)\r\n\t}\r\n\r\n\treturn {inputValue, inputChanged, suggestions, showSuggestions, clear, selectOption}\r\n}","import React from 'react'\r\nimport {FieldDef} from '../../FormDef'\r\nimport {useExpression} from '../../hooks/useExpression'\r\nimport {FormElementProps} from '../FormElementProps'\r\n\r\ninterface TextOutputDef extends FieldDef {\r\n\texpression?: string\r\n\tvalue?: string\r\n}\r\n\r\nexport const TextOutput = (props: FormElementProps<TextOutputDef>) => {\r\n\tconst {evaluate} = useExpression()\r\n\tif (props.def.expression) {\r\n\t\treturn <>{evaluate(props.def.expression, props.path, props.def)}</>\r\n\t}\r\n\tif (props.def.value) {\r\n\t\treturn <>{props.def.value}</>\r\n\t}\r\n\treturn null\r\n}","import React from 'react'\r\nimport {ElementDef, FieldDef} from '../FormDef'\r\nimport {useShowIf} from '../hooks/useShowIf'\r\nimport {createPath} from '../util'\r\nimport {FormElementProps} from './FormElementProps'\r\nimport {lookupElement} from './formElementTypes'\r\n\r\nexport const ChildFormElements: React.FC<{ childFormElements: (FieldDef | ElementDef)[], parentPath: string }> = (props) =>\r\n\t<div>\r\n\t\t{props.childFormElements.map((elementDef, index) => {\r\n\t\t\tconst path = createPath(props.parentPath, elementDef.fieldId)\r\n\t\t\treturn <ChildFormElement path={path} parentPath={props.parentPath} elementDef={elementDef} key={path + '_' + index}/>\r\n\t\t})}\r\n\t</div>\r\n\r\nconst ChildFormElement: React.FC<{ path: string, parentPath: string, elementDef: ElementDef }> = (props) => {\r\n\tconst {shouldShow} = useShowIf()\r\n\tif (!shouldShow(props.path, props.elementDef)) {\r\n\t\treturn null\r\n\t}\r\n\tconst Child: any = lookupElement(props.elementDef.type)\r\n\tconst childProps: FormElementProps = {\r\n\t\tdef: props.elementDef,\r\n\t\tparentPath: props.parentPath,\r\n\t\tpath: props.path\r\n\t}\r\n\treturn React.createElement(Child, childProps)\r\n}","import React, {useLayoutEffect} from 'react'\r\nimport FormDef from './FormDef'\r\nimport {ChildFormElements} from './formElements/ChildFormElements'\r\nimport {useConfig} from './hooks/useConfig'\r\nimport {useFormDef} from './hooks/useFormDef'\r\nimport {useFormState} from './hooks/useFormState'\r\nimport {useReferenceData} from './hooks/useReferenceData'\r\n\r\nexport interface FormProps {\r\n\tformDef: FormDef\r\n}\r\n\r\nexport const Form: React.FC<FormProps> = (props) => {\r\n\tconst {setupFormDef} = useFormDef()\r\n\tconst {setupConfig} = useConfig()\r\n\tconst {setupReferenceData} = useReferenceData()\r\n\r\n\t/* eslint-disable react-hooks/exhaustive-deps */\r\n\tuseLayoutEffect(() => {\r\n\t\tsetupFormDef(props.formDef)\r\n\t\tsetupConfig(props.formDef.config)\r\n\t\tsetupReferenceData(props.formDef.referenceData)\r\n\t}, [])\r\n\t/* eslint-enable react-hooks/exhaustive-deps */\r\n\r\n\tconst outcomeIndex = useFormState().formState.outcomeIndex\r\n\tif (outcomeIndex != null) {\r\n\t\treturn <div className=\"outcome container\">\r\n\t\t\t<ChildFormElements childFormElements={props.formDef.submit.outcomes[outcomeIndex].elements} parentPath=\"\"/>\r\n\t\t</div>\r\n\t}\r\n\r\n\treturn <div className=\"form\">\r\n\t\t<ChildFormElements childFormElements={props.formDef.elements} parentPath=\"\"/>\r\n\t</div>\r\n}","//import 'react-app-polyfill/ie11'\r\nimport axios from 'axios'\r\nimport React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport {Form} from './Form'\r\nimport FormDef from './FormDef'\r\nimport {StoreProvider} from './hooks/useStore'\r\n\r\nimport './index.css'\r\n\r\naxios.get<FormDef>('api/formDefinition/exampleFormDefinition.json')\r\n\t.then(function (response) {\r\n\t\tReactDOM.render(\r\n\t\t\t<StoreProvider>\r\n\t\t\t\t<Form formDef={response.data}/>\r\n\t\t\t</StoreProvider>,\r\n\t\t\tdocument.getElementById('form')\r\n\t\t)\r\n\t})"],"sourceRoot":""}